<!doctype html>
<html>
<head>
<meta charset="UTF-8">
<title>HTML5 Web Messagingのサンプル</title>
</head>
<body>
<h1>送る側</h1>
<p>まずボタンを押して受け取る側のウィンドウを開きます。その後フォームからメッセージを送ります。</p>
<p><input type="button" value="ボタン" onclick="openwindow()"></p>
<form onsubmit="send(event)">
<p><input type="text" name="message" size="50"><input type="submit" value="送信"></p>
</form>
<script>
var towindow;	//メッセージを送る先のウィンドウ
function openwindow(){
	towindow=window.open("13_3_sample.html");
}

//onsubmit（フォームが送信されたとき）に呼び出される
function send(ev){
	//evはイベントオブジェクト。
	var form=ev.target;
	
	//towindowに何も入っていない（ウィンドウが開いていない）ならやめる
	if(!towindow)return;
	
	//メッセージを送る
	towindow.postMessage(form.elements["message"].value,"/");
	
	//フォームの送信は中止する
	ev.preventDefault();
	//フォームは空の状態に戻す
	form.reset();
}
</script>
</body>
</html>
