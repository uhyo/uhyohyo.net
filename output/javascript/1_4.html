<!doctype html>
<html lang="ja-jp">
  <head>
    <meta charset="UTF-8">
    <link href="/css/css.css" rel="stylesheet">
                  <link href="/css/js.css" rel="stylesheet">
                        <title>一章第四回　オブジェクトと関数 — JavaScript初級者から中級者になろう &#x2014; uhyohyo.net</title>
        <script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-46093038-1', 'auto');
ga('send', 'pageview');
    </script>
  </head>
  <body>
    <header>
      <h1>
        <a href="/">uhyohyo.net</a>
      </h1>
    </header>
    <main>
      
<article> 
  <h1>JavaScript初級者から中級者になろう</h1>
  <aside class="ad-javascript">
    <!-- Google Adsense -->
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<ins class="adsbygoogle"
     style="display:inline-block;width:180px;height:150px"
     data-ad-client="ca-pub-1080533149094679"
     data-ad-slot="7536196754"></ins>
    <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
  </aside>
        <nav>
      <p>
        <a href="index.html" rel="bookmark">戻る</a>
                            |
          <a rel="prev" href="1_3.html">一章第三回</a>
                          |
          <a rel="next" href="2_1.html">二章第一回</a>
              </p>
    </nav>
    <h2>一章第四回　オブジェクトと関数</h2>
<h3>関数もオブジェクトだ</h3>
<p>「オブジェクト」について多少わかってきたので、ここで<strong>関数</strong>という存在を見直してみましょう。</p>
<p>実は、基本的にJavaScriptでは全てのものが<strong>オブジェクト</strong>か<strong>プリミティブ</strong>です。関数はどちらに入るのでしょう。</p>

<p>実は<strong>関数もオブジェクトです</strong>。ただ、すごく特殊なオブジェクトであるのは分かると思います。「<code>()</code>」をつけると<strong>呼び出す</strong>ことができるというのは関数だけがもつ特徴です。</p>
<p>実際、配列なんかよりももっと特殊なオブジェクトという位置づけです。しかし、オブジェクトであることは確かです。次のサンプルを見てみましょう。</p>
<pre><code>function aaa(){
  alert("test");
}
aaa();

alert(aaa);
        </code></pre>
<p>アラートを表示するだけの関数aaaを作り、それを呼び出しています。よって、「"test"」のアラートが表示されます。</p>
<p>しかし、次の行でやっていることはなんでしょう。なんとそのaaaを表示しています。そして、出るアラートには、関数aaaの中身が表示されています。</p>
<p>実は、関数をアラートで表示すると、その中身が表示されるようになっています。それより、アラートの引数がaaaだということは、aaaを変数のように使っているということです。実は、その通りaaaも変数だといっていいです。</p>
<p>実は、<code>function <var>関数名</var>(){ 〜 }</code>のような表記では、「『<var>関数名</var>』という名前の関数をつくる」というように<a href="kiso4.html">基礎第四回</a>で解説しましたが、もっと正確には、<strong>関数（のオブジェクト）を作り、その関数への参照を<var>関数名</var>に代入する</strong>という処理をしているといえます。</p>
<p>つまり、普通のオブジェクトと同じように、<strong>変数</strong>aaaには関数への参照が入っていたのです。それに「<code>()</code>」を付けて呼び出す呼び出し方をすると、関数として呼び出せるというわけです。</p>

<h4>もともとある関数の中身</h4>
<p>上で関数を変数としてアラートで表示すると、中身を表示できることを解説しました。それでは、次の場合はどうでしょう。 </p>
        <pre><code>alert(alert);</code></pre>
<p>ややこしいですが、alert関数で、変数alertが表す関数の中身を表示しています。注意として、1つめ（左）のalertは関数呼び出しのalertで、2つめ（右）のalertは変数名としてのalertだということです。</p>
<p>これでalert関数の中身が見られるはずです。ちなみに、ブラウザによって違いがありますが、Operaでは<q>function alert() { /* source code not available */ }</q>と表示されました。</p>
<p>中身があるべき部分に、コメントで「source code not available」と書いてあります。英語ですが、直訳すると「利用できないソースコード」となります。意味が分かりにくいですが、このalertはJavaScriptとは少し離れたところで処理をしていて、<strong>処理の中身はJavaScriptで書かれていない</strong>のです。基本的にもともとある関数は、自分で作った関数のように処理がJavaScriptでは書かれていません。ブラウザ本体がもつ機能とJavaScriptの架け橋であるといえます。JavaScriptとは違うため、JavaScriptで表せないから「利用できない（見ることができない）ソースコード」なのです。</p>
<p>しかし、もともとある関数でまた特別だとはいっても、オブジェクトであることは確かです。</p>

<h3>メソッド</h3>
<p><dfn>メソッド</dfn>というものを解説します。そんなに難しいものではなく、<strong>プロパティのうち、関数であるもの</strong>のことをメソッドといいます。つまり、プロパティの一種です。</p>
<pre><code>var a = {};
a.abc=<mark>test</mark>;
a.abc();

function test(){
    alert("test");
}</code></pre>
<p>やっていることは難しくありません。1行目でaに<code>{}</code>を代入していますが、これは「プロパティを1つも持たないオブジェクト」です。「<code>プロパティ名 : 値</code>」の組が1つもないわけですね。</p>
<p>そして、その後a.abcにtestを代入しています。これは、当然aのプロパティabcです。このabcの参照先はtestの参照先と同じですから（変数testに入っている関数オブジェクトへの参照をa.abcにも代入したと考えてください）、abcは<strong>メソッド</strong>であるといえます。</p>
<p>次の行ではそれを呼び出しています。正常に呼び出せていることが分かります。</p>
<p>もともとメソッドの本当の意味はこんなところには無いのですが、それは今回は解説しません。オブジェクトにくっついてる関数をメソッドと呼ぶということは覚えておきましょう。</p>
<p>ちなみこのように、関数定義は、使う場所より後ろに書いてあっても機能します。</p>

<h3>関数式</h3>
<p>関数を作る方法が、実は他にもあります。</p>
<pre><code>var aaa = function (){
    alert("test");
};

aaa();
        </code></pre>
<p>1行目がaaaに何かを代入している文なのは分かると思いますが、代入されているものは</p>
        <pre><code>function (){ alert("test"); }</code></pre>
<p>です。実はこれは、関数を定義するときに使うやつの、関数名を省略した形であるのがわかると思います。</p>
<p>この形にすると、<code>[ 〜 ]</code>の配列や<code>{ 〜 }</code>のオブジェクトと同じように、変数に代入したりできます。このように作られる関数のことを関数式といいます。式というのは、演算子のオペランドになったり関数の引数になったりできるものだということです。</p>
<p>実は、上で解説したメソッド作りなんかはこの記法が主流です。つまり、こういうことです。</p>
<pre><code>var a = {};
    a.abc = function(){
    alert("test");
};
        </code></pre>
<p>注意するべきなのは、あくまで代入文なので、<code>function(){ 〜 }</code>の後には「<code>;</code>」を付けるべきだという点です。通常の関数の定義ではつけていませんでしたね。</p>
<p>また、次のようなこともできます。</p>
<pre><code>var a = {
    abc : function(){ alert("abc"); },
    aaa : function(){ alert("aaa"); }
};
a.abc();
a.aaa();
        </code></pre>
<p>最初にオブジェクトを作る時点で、既にabcとaaaのメソッドを作っています。</p>
<p>次のこれは分かるでしょうか。</p>
<pre><code>var a = function(){
    return function(){
        alert("test");
    };
};
a()();
        </code></pre>
<p>これが正しく理解できれば、かなり力がついているといえるでしょう。</p>
<p>最後で「<code>()</code>」が2回つく謎の関数呼び出しが行われていますが、実はこれは新しい記法というわけではありません。</p>
<p>まず、関数aを見てみます。すると、関数aの中でまた関数があるのが分かります。その前には「return」とあります。戻り値を返すreturnです。</p>
<p>これは、関数aが</p>
<pre><code>function(){
            alert("test");
            }</code></pre>
<p>を返すだけの関数であることを表しています。返されるほうの関数は、ただアラートを表示するだけですね。</p>
<p>ここで最後の謎の文を見てみると、まず「<code>a()()</code>」のうち最初の「<code>a()</code>」が処理されます。つまりは関数aを呼び出しているのです。</p>
<p>戻り値が返されるとそれに置き換わるので、この文は次のようになります。</p>
<pre><code><mark class="ins">function(){
              alert("test");
              }</mark>();</code></pre>
<p>
  最後の「<code>();</code>」がもともとあったやつで、その前の<code>function(){ 〜 }</code>が返されたやつです。</p>
<p><code>function(){ 〜 }</code>が実質的に返すのは<strong>参照</strong>なので、<code>参照();</code>のような文に実質的になっていることがわかります。</p>
<p>したがって、その参照が呼び出されてアラートが表示されたというわけです。</p>

<p>もっとも、さすがにわかりにくすぎるので例えばこんなふうに書きます。</p>
        <pre><code><mark class="ins">(</mark>a()<mark class="ins">)</mark>();</code></pre>
<p>最初の<code>a()</code>が<code>( 〜 )</code>で囲まれています。</p>
<p>今度はa()が何かの引数になってしまったようにも見えますが、実はこの(〜)は関数呼び出しの()ではありません。これは優先順位を高めるためのものです。</p>
<p>例えば、掛け算より足し算を先にしたいとき、「（３＋５）×２」のようにします。括弧の中が先に計算されるのでした。これと同じはたらきです。</p>
<p>今回の場合、もともとこの部分が先に計算されるので意味がないように思えますが、見た目少し分かりやすくなります。このように、見た目を分かりやすくするために括弧が使われることもあります。</p>

<h4>無名関数</h4>
<p>また、次のような書き方がそもそもできます。</p>
        <pre><code>(function(){ alert("test"); })();</code></pre>
<p>実は、さっきのサンプルで<code>a()</code>が処理され終わった後と同じ形です。</p>
<p>右の<code>()</code>によって、</p>
        <pre><code>(function(){ alert("test"); })</code></pre>
<p>が呼び出されます。このとき、呼び出された関数は<strong>名前がつけられていません</strong>。このような関数を<dfn>無名関数</dfn>などといいます。<code>function(){ 〜 }</code>で作られる関数は無名関数であるといえます。</p>
<p>他の変数に代入してしまえば無名関数はその変数を通して名前を持つことになりますが、今回の場合、代入もしていないので本当に無名です。このようなものだけを特に無名関数という場合もあります。</p>
<p>名前を持たないので、今回<code>()</code>で呼び出した後は、二度とこの関数には触れなくなってしまいます。この関数を参照する変数が、つまりこの関数にたどりつくための名前が無いわけです。</p>
<p>それなら関数にする意味もないかもしれませんが、大規模な処理をする場合など、関数の中で<strong>ローカル変数</strong>を使えることが役に立つ場合もあります。たくさん変数を使う処理をすると、他のところで使っている変数とかぶってしまうかもしれません。しかし、新しい関数をつくってその中でローカル変数を作って処理すれば、外には影響を与えないのです。</p>

<p>関数については、さらに紹介するべき事柄が多くあります。特に、<a href="9_5.html">九章第五回</a>で詳しく解説しています。</p>
        <nav>
      <p>
        <a href="index.html" rel="bookmark">戻る</a>
                            |
          <a rel="prev" href="1_3.html">一章第三回</a>
                          |
          <a rel="next" href="2_1.html">二章第一回</a>
              </p>
    </nav>
  </article>

    </main>
  </body>
</html>
    
