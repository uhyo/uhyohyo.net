<!doctype html>
<html lang="ja-jp">
  <head>
    <meta charset="UTF-8">
    <link href="/css/css.css" rel="stylesheet">
                  <link href="/css/js.css" rel="stylesheet">
                        <title>四章第二回　正規表現 — JavaScript初級者から中級者になろう &#x2014; uhyohyo.net</title>
      </head>
  <body>
    <header>
      <h1>
        <a href="/">uhyohyo.net</a>
      </h1>
    </header>
    <main>
      
<article> 
  <h1>JavaScript初級者から中級者になろう</h1>
  <aside class="ad-javascript">
    <!-- Google Adsense -->
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<ins class="adsbygoogle"
     style="display:inline-block;width:180px;height:150px"
     data-ad-client="ca-pub-1080533149094679"
     data-ad-slot="7536196754"></ins>
    <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
  </aside>
        <nav>
      <p>
        <a href="index.html" rel="bookmark">戻る</a>
                            |
          <a rel="prev" href="4_1.html">四章第一回</a>
                          |
          <a rel="next" href="4_3.html">四章第三回</a>
              </p>
    </nav>
    <h2>四章第二回　正規表現</h2>
<p><dfn>正規表現</dfn>は、とても面白い機能です。さらに文字列操作の幅が広がります。</p>

<h3>正規表現とは</h3>
<p>正規表現は、基本的には文字列を<strong>検索</strong>するために使うものです。前回indexOfというもので文字列を検索できることを解説しましたが、あれは、ただある文字列が含まれているかどうかだけを検索するという、単純なものです。</p>
<p>正規表現を使うと、もっと複雑な検索条件を指定することができます。</p>

<h3>正規表現の書き方</h3>
<p>さて、正規表現を書くとは、つまり検索条件を書くということです。複雑な検索条件が書けると言いましたが、さすがに日本語や英語で書いてもコンピューターに伝わらないので、専用の書き方がありますそれが正規表現です。例えば、</p>
        <pre><code>abc</code></pre>
<p>これは、正規表現のもっとも簡単な形です。ただ「abc」とあるだけですが、この正規表現は「<code>"abc"</code>である」という条件を表しています。これくらいの検索ならindexOfでもできますね。</p>

<p>次に、</p>
        <pre><code>a<mark>.</mark>c</code></pre>
<p>という形です。「b」が「<code>.</code>」に変わりました。</p>
<p>同じように"<code>a.c</code>"という文字列であるという条件かと思いきや、そうではありません。ここで、<code>.</code>は<strong>特別な意味を持つ文字</strong>です。</p>
<p>それでは、これはどんな意味を持つかというと、<strong>どんな文字でも当てはまる</strong>というものです。「<code>.</code>」の部分に当てはまる文字は、何でもよいのです（例外的に、改行だけはこれに当てはまりません）。</p>
<p>つまり、「aac」も「abc」も、「aあc」「a(c」なども条件に合うことになります。</p>
<p>ちなみに、このように条件に合うことを、<dfn>マッチする</dfn>といいます。</p>

<p>さて、幅はもっともっと広がります。</p>
        <pre><code>ab<mark>+</mark>c</code></pre>
<p>新しい記号<strong><code>+</code></strong>が登場しました。これも特別な記号です。</p>
<p>この記号の意味は、<strong>直前の文字が1つ以上繰り返している</strong>です。直前の文字は、今回の場合bですね。1つ以上ということは、<strong>数を限定しない</strong>のです。つまり、<strong>1つ以上なら何個でもいい</strong>ということです（1つしかなくても「繰り返している」ことにします）。ここがポイントです。</p>
<p>つまり、この条件は、「abc」にマッチするほか、「abbc」「abbbc」「abbbbc」「abbbbbc」・・・にもマッチします。</p>

<p>また、似たようなものに</p>
        <pre><code>ab<mark>*</mark>c</code></pre>
<p>というものがあります。「+」が「*」に変わりました。この記号は、1つ以上ではなく「<strong>0個以上</strong>」を表します。つまり、直前の文字が0個でもいい（<strong>無くてもいい</strong>）のです。つまり、この正規表現は、+の場合に加えて、bが1個もない形である「ac」にもマッチします。</p>

<p>次に、今紹介した2つを組み合わせた形もありえます。</p>
        <pre><code>a<mark>.+</mark>c</code></pre>
<p>この場合、+の直前の文字は<code>.</code>です。この<code>.</code>は、どんな文字でも当てはまるものでした。それが、+によって何個でも良くなったということは、この正規表現は、<strong>aとcの間に何がどれだけ入っていてもいい</strong>ということになります。</p>
<p>+は「1つ以上」なので、まったく何も入っていない「ac」という形はマッチしません。しかし、それ以外なら、「abc」も「a1234c」も「aあいうえおc」「akjijgifc」でも、aとcの間に何かが入っている形であればなんでもマッチします。もちろん、<code>a.<mark>*</mark>c</code>ならば「ac」にもマッチします。</p>

<p>さて、まだまだ書き方はあります。</p>
        <pre><code>a<mark>[abcde]</mark>c</code></pre>
<p>という書き方があります。[ 〜 ]まででひとかたまりに扱います。</p>
<p>この意味は、<strong>その中に含まれている文字のうちのどれか</strong>ということになります。中に含まれている文字とは、「abcde」の部分です。</p>
<p>つまり、「aまたはbまたはcまたはdまたはe」ということになるから、この正規表現は、「aac」「abc」「acc」「adc」「aec」のいずれかにマッチします。</p>
<p>また、aからeは連続したアルファベットだから、次のように省略することができます。</p>
        <pre><code>a[<mark>a-e</mark>]c</code></pre>
<p>aとeの間のハイフンのおかげで、「a-e」が「aからe」という意味になります。これを利用し、</p>
        <pre><code>[a-z]</code></pre>
<p>は「aからz」だから小文字のアルファベット全てのマッチします。</p>
<p>また、この組は複数書くことができるから、</p>
        <pre><code>[a-zA-Z]</code></pre>
<p>のような書き方もできます。この場合、「aからzとAからZ」という意味になり、アルファベット全てになります。</p>
<p>この範囲指定は文字コードに基づいています。</p>

<p>また、 </p>
<pre><code>[<mark>^</mark>abcde]

[<mark>^</mark>a-zA-Z]
</code></pre>
<p>のように、中の先頭に<strong><code>^</code></strong>をつけると意味が変わり、「その中の文字<strong>以外</strong>の文字のどれか」ということになります。意味が逆になりますね。</p>

<h3>JavaScriptで正規表現</h3>
<p>さて、まだまだ解説すべきことはたくさんありますが、ここで一度休憩して、実際にJavaScriptで正規表現を扱ってみたいと思います。</p>

<h4>正規表現オブジェクト</h4>
<p>JavaScriptでは、正規表現（検索条件）はオブジェクトの形で表現します。それが正規表現オブジェクト(RegExpオブジェクト)です。</p>
<p>正規表現オブジェクトを作るには、特別な書き方があります。それは、</p>
        <pre><code>/<mark>正規表現</mark>/</code></pre>
<p>という書き方です。「正規表現」の部分は、「ab+c」とか「a[a-e]c」とかの条件の部分です。<code>"</code>で囲むと文字列になりますが、そのかわりに<code>/</code>で囲むと正規表現オブジェクトを表すのです。</p>
<p>このような書き方は、[ 〜 ]で配列を作ったり、{ 〜 }で普通のオブジェクトを作るのと似ています。</p>

<h4>文字列にマッチさせる</h4>
<p>さて、ある文字列に正規表現がマッチするかどうか調べるためには、次のようにします。すなわち、正規表現オブジェクトの持つtestメソッドを用います。</p>
        <pre><code><var>正規表現オブジェクト</var>.<dfn>test</dfn>(<var>文字列</var>)</code></pre>
<p>このtestメソッドの戻り値は<strong>真偽値</strong>で、マッチすればtrue、しなければfalseを返します。</p>
<p>また、文字列を正規表現にマッチさせという場合、文字列のどこか一部分が条件を満たしていればマッチします。</p>

<p>いくつか例を見てみましょう。</p>
<pre><code>if( /bcd/.test("abcde") ){
    console.log("マッチしました");
}else{
    console.log("マッチしませんでした");
}</code></pre>
<p>これでは、文字列<code>"abcde"</code>が、正規表現<code>/bcd/</code>にマッチするかどうか判定しています。これはマッチしているので、trueが返り、if文の中が実行されます。</p>
<pre><code>abcde
 <mark>‾‾‾</mark></code></pre>
<p>の部分がマッチしたわけです。</p>

<h3>正規表現の書き方</h3>
<p>再び、正規表現の書き方を解説していきます。</p>
        <pre><code>ab<mark>{4}</mark>c</code></pre>
<p>ここで、<code>{4}</code>が新しい書き方です。これは、「<strong>直前の文字を4回繰り返す</strong>」というもので、なぜ4回かは、当然、{ }の中が4だからです。一般化すると、<code>{n}</code>という指定は、「<strong>直前の文字をn回繰り返す</strong>」というようになります。</p>
<p>直前の文字はbだから、これは「abbbbc」という文字列にマッチすることになります。+ や * も同じ繰り返しですが、あちらは繰り返す回数に制限がないのが大きな特徴でした。こちらは、回数を指定することができます。</p>

<p>また、もう少し幅を持たせて、次のような表現が可能です。</p>
        <pre><code>ab<mark>{2,5}</mark>c</code></pre>
<p>今度は、{ 〜 }の中の数値が<code>,</code>で区切られて2つになりました。</p>
<p><code>{m,n}</code>のように2つの数値を区切って書いたとき、<strong>直前の文字をm回以上n回以下繰り返した文字列</strong>にマッチします。</p>
<p>上の書き方は4回以外はマッチしませんでしたが、今回はもう少し幅があって、2回以上5回以下となっています。つまり、「abbc」「abbbc」「abbbbc」「abbbbbc」にマッチします。</p>

<p>もう1つあって、それは次のような書き方です。</p>
        <pre><code>ab<mark>{2,}</mark>c</code></pre>
<p>前と同じように2つの数値を区切って書く書き方かと思いきや、2つめの数値が省略されています。この書き方は、繰り返しの最低回数は指定するが、最高回数は制限しないという場合の方法です。</p>
<p>つまり、今回の場合「2回以上」ということになり、「abbc」「abbbc」「abbbbc」・・・にマッチします。</p>

<p>これでこのシリーズは終了です。さらに、</p>
        <pre><code>ab<mark>?</mark>c</code></pre>
<p>という書き方ができます。この「?」は、<strong>直前の文字が0回または1回</strong>という意味です。つまり、「ac」か「abc」にマッチします。</p>

<h4>グループ化</h4>
<p>グループ化というものがあります。これは、<strong>複数の文字をひとまとめに扱うことができるもの</strong>です。グループ化は、</p>
        <pre><code>a<mark>(</mark>bc<mark>)</mark></code></pre>
<p>のようにします。ひとまとめにしたい部分を、( 〜 )で囲むだけです。</p>
<p>これだけでは何もかわりませんが、これを例えば次のように利用できます。</p>
        <pre><code>a(bc)<mark>+</mark></code></pre>
<p>+は直前の文字を1回以上繰り返すというものでした。ここで、直前の文字は、cというわけではなくなります。( 〜 ) でbcをひとまとめにして扱ったから、「bc」を繰り返すということになります。</p>
<p>従って、「abc」「abcbc」「abcbcbc」「abcbcbcbc」・・・　にマッチするということになります。</p>
<p>+以外にも、*や{〜}や?などでも同じです。</p>

<p>さて、次のような書き方もあります。</p>
        <pre><code>aaa<mark>|</mark>abc</code></pre>
<p>「aaa」と「abc」が|で区切られています。これは単純に「aaaかabcの<strong>どちらか</strong>」という意味です。この正規表現でマッチさせる場合、aaaかabcのどちらかが含まれていればマッチします。</p>
<p><code>aaa|abc|zzzzz</code>のように、3つ以上候補をたてることも可能です。</p>
<p>さて、これを他の書き方に組み込むとどうなるでしょう。例えば、<code>1234</code>の後に<code>aaa|abc|zzzzz</code>（aaaかabcかzzzzzのどれか）が続く場合、</p>
        <pre><code>1234aaa|abc|zzzzz</code></pre>
<p>のように書くと、「『1234aaa』か『abc』か『zzzzz』」という意味になってしまいます。</p>
<p>ここで、上のグループ化が登場します。</p>
        <pre><code>1234<mark>(</mark>aaa|abc|zzzzz<mark>)</mark></code></pre>
<p>のように書くことで、正しくマッチします。見た目にも1234とaaa|abc|zzzzzが分離していることがわかります。</p>
<p>これは、「1234aaa」「1234abc」「1234zzzzz」のいずれかにマッチします。</p>

<h4>1文字である種類の文字のどれかを表す特殊な文字</h4>
        <pre><code><mark>\s</mark></code></pre>
<p>という書き方があります。ここで、\sは2文字でセットです。一般に、「<code>\</code>」は、その次の文字と合わさって特殊な意味を持ちます。</p>
<p>それでは、この\sはどういう意味を持つかというと、<strong>空白文字</strong>にマッチします。空白文字は、文字通り空白のことで、半角スペース、タブなど、空白を表す文字が当てはまります。</p>

<p>他にも、<code><mark>\d</mark></code>というのもあります。今度はsではなくdです。これは、<strong>数字1文字</strong>です。数字とは、0から9だから、<code>[0-9]</code>と同じ意味になります。これも結構使われます。</p>

<p>ここで、今まで特殊な意味の文字がいろいろ出てきました。<code>. + * ? { } ( ) [ ] | \</code>などです。それでは、これらの文字を、特殊な意味ではなく、これらの文字そのものが含まれるという意味で使いたい場合には、どうしればいいのでしょうか。</p>
<p>実は、<code><mark>\</mark>. <mark>\</mark>+ <mark>\</mark>*</code>
  などのように、前に\をつければ、それは特殊な意味ではなく、その文字そのものとして扱われます。これは覚えておきましょう。つまり例えば、<code>3<mark>\+</mark>2</code>という正規表現の場合、<code>"3<mark>+</mark>2"</code>といた文字列にマッチします。</p>

<h4>位置を指定する文字</h4>
<p>今まで、書いたものはみんなそれぞれ文字にマッチしてきました。そうではなく、<strong>位置</strong>を指定するための特殊な文字もあります。</p>
<p><code><mark>^</mark>abc</code>という書き方があります。先頭に<code>^</code>がついていて、実は、この文字は、その位置が<strong>行頭</strong>であることを示します。文字列が1行だけなら（1行のことが多いですが）、<strong>文字列の先頭</strong>であることを表します。</p>
<p>今回検索する文字列が1行だとすると、先頭の直後にabcがあるから、<strong>abcで始まる文字列</strong>にマッチします。</p>
<p>だから、同じabcでも、</p>
<pre><code>1234abc
    <mark>‾‾‾</mark>
          </code></pre>
<p>や</p>
<pre><code>aabcdefg
 <mark>‾‾‾</mark>
          </code></pre>
<p>にはマッチせず、</p>
<pre><code>abcdefgh
<mark>‾‾‾</mark>
          </code></pre>
<p>にはマッチするということになります。</p>

<p>また、同じように<strong>行末</strong>を表す文字もあります。1行なら<strong>文字列の最後</strong>ですね。ここから先は、文字列は1行だということで解説を進めます。</p>
<p>それは、<code>abc<mark>$</mark></code>という書き方です。この場合、</p>
<pre><code>aaaabcdefg
   <mark>‾‾‾</mark>
          </code></pre>
<p>や</p>
<pre><code>abcdefg
<mark>‾‾‾</mark>
          </code></pre>
<p>にはマッチせず、</p>
<pre><code>aaabc
  <mark>‾‾‾</mark>
        </code></pre>
<p>にはマッチするということです。</p>

<p>これらを組み合わせて、</p>
        <pre><code><mark>^</mark>abc<mark>$</mark></code></pre>
<p>とするとどうでしょう。abcが最初であり最後であるということだから、</p>
<pre><code>abcdef
<mark>‾‾‾</mark>
        </code></pre>
<pre><code>aaaaabc
    <mark>‾‾‾</mark>
</code></pre>
        <p>にはマッチせず、</p>
<pre><code>abc
<mark>‾‾‾</mark>
</code></pre>
        <p>という、文字列が完全にそれと一致する場合のみマッチします。結構使える技です。</p>

        <p>最後に、 <code>\S \D</code>を紹介します。\Sは「\s<strong>以外</strong>」、\Dは「\d<strong>以外</strong>」にマッチします。たまに使います。</p>
        <p>具体的には、\sは空白文字だから、\Sは「空白文字以外の任意の文字」、\dは数字だから、\Dは「数字以外の任意の文字」にマッチすることになります。</p>
        <p>正規表現は、よく使うものはだいたい解説しましたが、他にもいろいろな書き方があります。自分で調べてみましょう。</p>
        <p>次回はJavaScriptから正規表現を活用する方法を紹介します。</p>
        <nav>
      <p>
        <a href="index.html" rel="bookmark">戻る</a>
                            |
          <a rel="prev" href="4_1.html">四章第一回</a>
                          |
          <a rel="next" href="4_3.html">四章第三回</a>
              </p>
    </nav>
  </article>

    </main>
  </body>
</html>
    
