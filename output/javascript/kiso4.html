<!doctype html>
<html lang="ja-jp">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <link href="/css/css.css" rel="stylesheet">
                  <link href="/css/js.css" rel="stylesheet">
                        <title>基礎第四回 — JavaScript初級者から中級者になろう &#x2014; uhyohyo.net</title>
        <script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-46093038-1', 'auto');
ga('send', 'pageview');
    </script>
  </head>
  <body>
    <header>
      <h1>
        <a href="/">uhyohyo.net</a>
      </h1>
    </header>
    <main>
      
<article> 
  <h1>JavaScript初級者から中級者になろう</h1>
  <aside class="ad-javascript">
    <!-- Google Adsense -->
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<ins class="adsbygoogle"
     style="display:inline-block;width:180px;height:150px"
     data-ad-client="ca-pub-1080533149094679"
     data-ad-slot="7536196754"></ins>
    <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
  </aside>
        <nav>
      <p>
        <a href="index.html" rel="bookmark">戻る</a>
                  |
          <a rel="prev" href="kiso3.html">前回</a>
                          |
          <a rel="next" href="kiso5.html">次回</a>
              </p>
    </nav>
    <h2>基礎第四回</h2>
<h3>関数の定義</h3>
<p>久しぶりに関数という言葉が出てきました。関数は、<a href="kiso1.html">基礎第一回</a>で<var>alert</var>が出てきました。今までよく使っています。</p>
<p>では、<strong>定義</strong>とはどういうことでしょう。この場合、<strong>関数を自分で作る</strong>ことです。関数は、もともとあるものの他に（もちろんalert以外にもたくさんあります）、自分で作ることができます。次のサンプルを見てみましょう。</p>
<pre><code>function aaa(){
    alert("test");
}
aaa();
        </code></pre>
<p>「test」というアラートが出ました。</p>
<p>4行目の「<kbd>aaa();</kbd>」の行で、aaaという関数を呼び出しているようです。このaaaが、今回自分で作った関数です。</p>
<p>1行目から3行目がなにやら怪しいですね。またまた見たことも無い形だと思います。これは新しい構文です。</p>
<pre><code>function <var>関数名</var>() {
    文（いくつでも）
} </code></pre>
<p>このようにすると、「<var>関数名</var>」という名前の関数が新しくできます。上のサンプルでは「aaa」でしたね。</p>
<p>どんな処理をする関数なのかを決めないとどうしようもないわけですが、それは<kbd>{ 〜 }</kbd>の中に書きます。</p>
<p>というのも、このようにして作った関数が「aaa()」のように呼ばれると、さっきの<kbd>{ 〜 }</kbd>の中の処理が行われます。<kbd>function <var>関数名</var>(){ 〜 }</kbd>はあくまで関数を作っているだけなので、その中の処理は関数が呼び出されたときしか行われません。つまり、プログラムが上から進んできて、この形（関数宣言といいます）の部分を通過してもそこで何か起きるわけではないということです。</p>

<p>さて、今回の場合、「aaa();」として関数aaaを呼び出すと、定義された<code>alert("test");</code>が実行されます。<kbd>{ 〜 }</kbd>の中の処理が終わるとaaa()の処理が終了したことになります。</p>

<p>関数の主な意義は繰り返し使えることにあります。例えば大規模な処理があるとして、プログラム中で同じ処理を3回使いたいとしたら、同じプログラムを3回書かないといけないことになり無駄です。</p>
<p>このとき、その大規模な処理をひとつの関数にしておくと、その処理を使いたいときはその関数を呼び出すだけでいいので簡単です（ただし、実際のプログラムでは関数を機能ごとに小分けして、あまり一つの関数が大規模にならないように気をつけるものなので、大規模な処理をひとつにまとめるというより、機能単位で処理をまとめるというほうが実は適切です）。</p>

<h3>引数のある関数</h3>
<p>alertには、引数があります。しかし、さっき作った関数aaaには引数がありませんでした。自分で作った関数にも、引数を<dfn>受け取らせる</dfn>ことができます。</p>
<p>受け取らせるとは、その関数が与えられた引数を使うということです。次のサンプルを見てみます。</p>
<pre><code>
function aaa(abc){
    alert("引数は" + abc + "です");
}
aaa(5);
aaa(3);
aaa("test");</code></pre>
<p>「引数は3です」「引数は5です」「引数はtestです」という三回のアラートが出ました。</p>
<p>最初の3行で関数aaaを定義し、次の3行で3回aaaを呼び出しています。今回、aaaに一つの引数を渡しているのが分かると思います。</p>
<p>さて、aaaの定義部分を見てみると、前回「<kbd>aaa(){ 〜 }</kbd>」だったのが「<kbd>aaa(abc){ 〜 }</kbd>」となっていて、括弧の中に「abc」というものがあります。</p>
<p>このabcは変数名で、aaaが呼び出されると、<strong>自動的に引数が代入されます</strong>。</p>

<p>1回目の<code>aaa(5);</code>では、aaaの中で変数abcに5が代入されていることになります。同様に、2回目では3、3回目では"test"が代入されます。</p>

<p>また、引数が2つ以上ある関数も作ることができます。</p>
<pre><code>function sum(aaa,bbb){
    alert(aaa + bbb);
}
sum(5,8);
sum("あああ","いいい");</code></pre>
<p>実行すると、「13」というアラートと「あああいいい」というアラートが表示されました。</p>
<p>今回はsum関数を2つの引数で呼び出しています。sum関数の定義を見てみると、括弧の中に<kbd>(aaa,bbb)</kbd>というように変数が2つ記述されています。このように「<kbd>,</kbd>」で区切るのは、関数呼び出しのときと同じ形式です。</p>
<p>それぞれの変数にそれぞれの引数が代入されます。順番もそのままです。つまり、1回目では、aaaに5が、bbbに8が代入されています。2回目では、aaaに"あああ"、bbbに"いいい"が代入されています。</p>

<h3>関数の中で変数を使う</h3>
<p>関数の中でも、当然引数が代入された変数以外にも自由に変数を使うことができます。次のサンプルを見てみましょう。</p>
<pre><code>
function aaa(){
    a = 3;
    alert(a);
}
a = 5;
alert(a);
aaa();
alert(a);</code></pre>
<p>「5」「3」「3」とアラートが表示されます。</p>

<p>今までの解説の知識でなんとか分かると思います。最初の4行は関数aaaの定義で、その次の行はaに5を代入しています。そのため、その次の行では5のアラートが表示されます。</p>
<p>次の行で関数aaaを呼び出しています。aに3を代入し、アラートでaを表示しているので、当然3が表示されます。</p>
<p>aaaの処理が終わり、次の行に進むと、またaをアラートで表示しています。さっき3を代入したので、また3が表示されます。</p>
<p>何も問題はありませんね。では、次のサンプルはどうでしょう。</p>
<pre><code>function aaa(){
<mark class="ins">var </mark>a = 3;
    alert(a);
}
a = 5;
alert(a);
aaa();
alert(a);</code></pre>
<p>「var」という謎の3文字が追加されています。</p>
<p>なんと、さっきと結果が変わりました。「5」「3」「5」と表示されます。</p>
<p>原因はもちろん「var」の行でしょう。実は、このように文の先頭に「<strong>var</strong>」をつけて代入した変数は、<dfn>ローカル変数</dfn>になります。</p>
<p>ローカル変数とは、その関数の中だけで通用する変数のことです。というより、名前が同じでも、その関数の中だけ別の変数のようになります。</p>
<p>このソースの動作をみてみましょう。「<kbd>a = 5;</kbd>」の行でaに5が代入され、次の行でそれを表示するところまでは同じです。</p>
<p>次の行でaaaが呼び出されると、同じようにaに3を代入しますが、ここで、このaはローカル変数になります。さっきまでのaとは<strong>別物</strong>で、この関数aaaの中だけで通用する新しいaです。</p>
<p>つまり、aaaの中で変数aに何をしようと、もともとのaとは別物なので、影響はありません。</p>
<p>さて、そのローカル変数のaに3を代入し、それを表示するので、3が表示されます。</p>
<p>ここで、aaaの処理が終了します。この時点でローカル変数のaはなくなります。</p>
<p>さて、その次の最後の行ではaを表示します。このaは、最初のaと同じaなので、5が表示されるというわけです。</p>

<h3>ローカル変数とグローバル変数</h3>
<p>上のサンプルのような場合、関数の外で使われる変数（ローカル変数に対して<dfn>グローバル変数</dfn>といいます）とローカル変数が同じ名前だったので、多少はローカル変数を使う意味が分かったと思います。</p>
<p>関数の外で使われる変数と関数の中で使われる変数の名前は一致しないことが多いと思いますが、だからといってローカル変数を使う必要が無いかというと、<strong>そうではありません。</strong></p>
<p>関数の中で使う変数は、<strong>ローカル変数にするのが鉄則</strong>です。</p>
<p>関数というのはひとかたまりの処理なので、処理はその関数の中で完結するべきです。つまり、関数の外と関わりを持たず、与えられた引数に応じて処理を行うだけなので、グローバル変数を使う必要はないということです。逆に、関数がグローバル変数を書き換えてしまうと、関数と直接関係ないところで副作用が生じることになり、プログラムが理解しにくくなったりバグの原因になるのです。場合に応じて例外もありますが、関数の中で作る変数は全てローカル変数にするものだと考えて問題ないでしょう。</p>

<pre><code>var a=3;
alert(a);</code></pre>
<p>ところで、このコードは、ごく普通に変数aに3を代入してそれを表示するコードです。</p>
<p>しかし、関数の中でもないのに、varをつけて変数に代入しています。関数の中ではないので、varがついていますがあくまでグローバル変数です。このように、関数ではないところでvarを使うことも可能ですが、意味はありません。ただ、varをつけると変数を新しく作っているのだということが一目瞭然なので、この処理ではこういう新しいグローバル変数を作って使っていますよ、ということを（プログラムを見る人に）示す効果があります。ですから、プログラムをわかりやすくするためにもできるだけつけておきましょう。</p>

<h3>戻り値のある関数</h3>
<p>今度は<dfn>戻り値</dfn>のある関数を作ってみましょう。</p>
<p>その前に、戻り値の解説をします。前に<strong>演算子</strong>が値を返すということを解説しましたが、実は<strong>関数も値を返す</strong>ことがあります。</p>
<p>しかし、今まで戻り値がある関数を解説したことがありません。というより、関数もalertしか解説したことがありません。そこで、もともとある新しい関数を紹介します。</p>

<h4>parseInt</h4>
<p>
  <code>var a = <dfn>parseInt</dfn>("12");
    alert(a + 5);</code>「17」というアラートが出ますね。「parseInt」が新しい関数です。</p>
<p>しかし、場所が今までと違いますね。aに「<kbd>parseInt("12")</kbd>」を代入しています。</p>
<p>演算子が計算結果に置き換わるように、関数をこのように使った場合、関数が返した<strong>戻り値</strong>に置き換わります。</p>
<p>つまり、<kbd>parseInt("12")</kbd>がその返り値に置き換わり、それがaに代入されるということになります。</p>
<p>さて、それではparseIntの返り値が何かですが、この関数は、<strong>引数を数値に変換して返します</strong>。</p>
<p>数値に変換するとはどういうことかというと、parseIntに渡した引数は「<kbd>"12"</kbd>」という<strong>文字列</strong>です。しかし、この文字列は数字を表す文字列です。だから、数値として使いたいときがあります。</p>
<p>そうした場合に、parseIntを使うと数値として得ることができます。つまり、こういうことです。</p>
<pre><code>var a = parseInt("12");
↓
var a = <mark class="ins">12</mark>;
        </code></pre>
<p>parseIntの次の行で<kbd>a+5</kbd>を表示していますが、aは12なので、12+5=17で17が表示されるというわけです。</p>
<p>parseIntが使えないと、こういう場合、</p>
<pre><code>alert(a + 5);
↓
alert(<mark class="ins">"12"</mark> + 5);
↓
alert(<mark class="ins">"125"</mark>);
        </code></pre>
<p>というようになり数値の計算ができません。今回の場合特に意味はないですが、画面上の入力ボックスに数を入力してもらう場合など、それを文字列でしか得ることができません。そういったときに、このparseIntが必要になります。</p>

<h4>戻り値のある関数を自分で作る</h4>
<p>それでは、戻り値のある関数を自分で作る方法を解説します。次のサンプルを見てみましょう。</p>
<pre><code>function sum(a,b){
    <dfn>return</dfn> a+b;
}
alert( sum(100,10) );</code></pre>
<p>「110」というアラートが出ます。</p>
<p>alertの行で、関数sumを呼び出してその戻り値を表示していることが分かると思います。</p>
<p>さて、sumの中を見てみると、<dfn>return</dfn>という怪しいものがあります。これが戻り値を返すはたらきをしているのです。</p>
<p>このreturnは、returnの後の値を戻り値として返すものです。この場合、戻り値はa+bということになります。</p>
<p>つまり、sumが呼び出されると、引数は100と10なので、a+bは100+10=110となり、関数sumは110を返します。それをalertで表示するので、110が表示されたというわけです。</p>

<p>また、returnがあると、関数はそこで終了します。それを応用し、次のような使い方ができます。</p>
<pre><code>function aaa(){
    return;
    alert("aaa");
}
aaa();</code></pre>
<p>これは、関数aaaを作って呼び出しています。</p>
<p>しかし、aaaの中にalertがあるのに、アラートは表示されません。そう、その前の行にreturnがあるからです。</p>
<p>このように、returnを使った場合、<strong>関数が終了します</strong>。returnで関数が終了したので、その次のalertは呼び出されなかったのです。ちなみにこの場合返り値はありませんが、その場合関数は何も返さないということになります（厳密には少し違いますが、ここでは解説しません）。</p>
        <nav>
      <p>
        <a href="index.html" rel="bookmark">戻る</a>
                  |
          <a rel="prev" href="kiso3.html">前回</a>
                          |
          <a rel="next" href="kiso5.html">次回</a>
              </p>
    </nav>
  </article>

    </main>
  </body>
</html>
    
