<!doctype html>
<html lang="ja-jp">
  <head>
    <meta charset="UTF-8">
    <link href="/css/css.css" rel="stylesheet">
                  <link href="/css/js.css" rel="stylesheet">
                        <title>三章第六回　mouseoveerとmouseout — JavaScript初級者から中級者になろう &#x2014; uhyohyo.net</title>
        <script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-46093038-1', 'auto');
ga('send', 'pageview');
    </script>
  </head>
  <body>
    <header>
      <h1>
        <a href="/">uhyohyo.net</a>
      </h1>
    </header>
    <main>
      
<article> 
  <h1>JavaScript初級者から中級者になろう</h1>
  <aside class="ad-javascript">
    <!-- Google Adsense -->
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<ins class="adsbygoogle"
     style="display:inline-block;width:180px;height:150px"
     data-ad-client="ca-pub-1080533149094679"
     data-ad-slot="7536196754"></ins>
    <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
  </aside>
        <nav>
      <p>
        <a href="index.html" rel="bookmark">戻る</a>
                            |
          <a rel="prev" href="3_5.html">三章第五回</a>
                          |
          <a rel="next" href="4_1.html">四章第一回</a>
              </p>
    </nav>
    <h2>三章第六回　mouseoveerとmouseout</h2>
<p>今回は、mouseoverとmouseoutという2つのイベントについて詳しく解説します。</p>
<pre><code>&lt;!doctype html&gt;
&lt;html&gt;
  &lt;head&gt;
    &lt;title&gt;test&lt;/title&gt;
    &lt;style type="text/css"&gt;
      p{
        background-color:yellow;
        width:300px;
        height:300px;
      }
    &lt;/style&gt;
  &lt;/head&gt;
  &lt;body&gt;

    &lt;p <mark>onmouseover</mark>="console.log('mouseover');" <mark>onmouseout</mark>="console.log('mouseout');"&gt;test&lt;/p&gt;

  &lt;/body&gt;
&lt;/html&gt;</code></pre>
<p>黄色い部分がp要素で、これにはmouseoverとmouseoutのイベントが設定されています。マウスがp要素の外からp要素の上にはいるとmouseover、p要素の上からp要素の外にでるとmouseoutが発生しているのがわかります。つまり、mouseoverとmouseoutというイベントは、ある要素の上にマウスが入ったときと出たときにそれぞれ発生するのです。ある部分にマウスが移動するとなにかが動くというような動作は、今でこそCSS3を用いて作られることが多いですが、一昔前はJavaScriptのこれらのイベントを使って実装されていました。</p>
<p>さて、ここで、body要素に注目します。body要素には、特にイベントが設定されていませんね。ここで、黄色い部分はp要素ですが、それ以外の部分は<strong>body要素</strong>です。p要素要素はbody要素の子ではあるものの、一応body要素とはまた別の領域です。</p>
<p>つまり、どういうことかというと、body要素からp要素の上にマウスが移動するとき、body要素から見ると、p要素という別の領域にマウスがいってしまうことだから、<strong>body要素でmouseoutが同時に発生する</strong>ということです。</p>
<p>同様に、p要素の上からbody要素にマウスが移動するとき、p要素ではmouseoutが発生しますが、body要素では、別の領域からbody要素の上にマウスが戻ってきたことになるから、<strong>body要素ではmouseoverが同時に発生する</strong>ということです。</p>
<p>このように、mouseoverとmouseoutは対になって発生します。さらに、<a href="3_3.html">三章第三回</a>で解説した<strong>イベントバブリング</strong>の考え方を加えると、p要素で<strong>発生</strong>したmouseoverやmouseoutは、body要素にも<strong>伝わり</strong>ます（あくまでイベントが<strong>発生</strong>したのはp要素で、body要素で実際に起こったというわけではなく、あくまで伝わるだけです）。</p>
<p>どういうことかというと、body要素では、<strong>mouseoverとmouseoutが同時に処理される</strong>ということです（ただし厳密には2つのプログラムを同時に実行できませんので、順番に処理されますが、そのタイミングは同じです）。</p>
<p>特に、前回みたように画面上のものは全てdocumentの下にあるから、どことどこの要素の間をマウスが移動しても、mouseoverとmouseoutはdocumentに伝わり、documentではmouseoverとmouseoutが同時に処理されます。</p>
<p>つまり、<strong>mouseoverとmouseoutは本質的に同じイベントである</strong>ということができます。</p>
<p>そこで、DOMでは、この2つを統一的に、まとめて扱う方法が用意されています。</p>
<pre><code>&lt;!doctype html&gt;
&lt;html&gt;
  &lt;head&gt;
    &lt;title&gt;test&lt;/title&gt;
    &lt;style type="text/css"&gt;
      p{
        background-color:yellow;
        width:300px;
        height:300px;
      }
    &lt;/style&gt;
  &lt;/head&gt;
  &lt;body&gt;

    &lt;p&gt;test&lt;/p&gt;

    &lt;script type="text/javascript"&gt;
      var listener = function(ev){
          console.log("target : "+ev.<mark>target</mark>.tagName,"relatedTarget : "+ev.<dfn>relatedTarget</dfn>.tagName);
      };

      <mark>document</mark>.addEventListener('mouseover' , listener,false);
    &lt;/script&gt;
  &lt;/body&gt;
&lt;/html&gt;</code></pre>
<p>今回は、mouseoverにイベントを登録しています。documentに登録しているということは、前回解説したように、この文書上のいかなる場所で起こったmouseoverも全て感知するということです。</p>
<p>さて、イベントリスナでは、イベントオブジェクトの持つプロパティtargetと、<dfn>relatedTarget</dfn>のtagNameを表示しています。targetは前回解説した通り、そのイベントが実際に起こった要素ですね。</p>
<p>今回新しく登場したのが、この<dfn>relatedTarget</dfn>です。tagNameというプロパティを持っていることから、これもHTMLElementであることが分かります。</p>
<p>このrelatedTargetは、感知したイベントと対になるイベントが起こった要素を表しています。例えば、body要素からp要素にマウスを動かしたとき、p要素でmouseoverが発生したから、targetは当然p要素です。このとき、マウスがbody要素の上から離れたことで、対になるmouseoutがbody要素で発生します。このbody要素がrelatedTargetになります。</p>
<p>実際にbody要素からp要素にマウスを動かしてみると、target.tagNameがPで、relatedTarget.tagNameがBODYであることが分かります。</p>
<p>もっと分かりやすく述べるならば、mouseoverの場合、マウスが移動した先の要素がtarget、移動元がrelatedTargetです。mouseoutは逆に、移動元がtarget、移動先がrelatedTargetです。</p>

<p>ついでに、いろいろ試していると、「P」「BODY」だけでなく「HTML」が出てくることがあるのに気づくかもしれません。実は、画面上にはbody要素ではない領域もあって、その部分はhtml要素が司っています。</p>
        <nav>
      <p>
        <a href="index.html" rel="bookmark">戻る</a>
                            |
          <a rel="prev" href="3_5.html">三章第五回</a>
                          |
          <a rel="next" href="4_1.html">四章第一回</a>
              </p>
    </nav>
  </article>

    </main>
  </body>
</html>
    
